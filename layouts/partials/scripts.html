{% if language === 'us' %}
<script>
    window.language = 'us';
</script>
{% elif language === 'de' %}
<script>
    window.language = 'de';
</script>
{% elif language === 'cn' %}
<script>
    window.language = 'cn';
</script>
{% endif %}

<script>
    $(document).ready(function () {
        enhance();
        setTimeout(showcontent, 500);
        setTimeout(removeloading, 1000);
    });

    function showcontent(){
        $('.dfit-outer-wrap').show();
        calculateSidebarWidth();
        smoothScroll();
        addActive();
    }

    function removeloading(){
        $('.dfit-loading').fadeOut(300);
    }

    function enhance(){
        enhance_videobg();
        // zoomImageHoverLink();
    }

    function enhance_videobg(){
        if($('#bgVid').length > 0 || $('#bgImg').length > 0) {
            $('.jumbotron').addClass('bg--transparent');
        }
    }

    //calculate fixed sidebar width
    function calculateSidebarWidth () {
        if ($('#sidebar-width')) {
            var menuWidth = $('#sidebar-width').width();
            $('.dfit-quick-guide-side').css({width: menuWidth});

            $('#sidebar-width').affix({
                offset: {
                    top: 500,
                    bottom: $('.dfit-updated').offset().top
//                    bottom: 850
                }
            })
        }
    }

    function smoothScroll() {
        //smoothscrolling and positioning
        $('a[href^="#"]').on('click', function (e) {
            // prevent default anchor click behavior
            e.preventDefault();
            // store hash
            var hash = this.hash;
            // animate
            $('html, body').stop().animate({
                scrollTop: $(hash).offset().top
            }, 600, 'swing', function () {
                window.location.hash = hash;
            });
        });
    }

    function addActive () {
        var language = window.language;
        var url = window.location.pathname;
        var child = '';
        if (language === 'us') {
            if (url.match('\/sectors\/')) {
                child = '/us/sectors/';
            } else if (url.match('\/investment-guide\/')) {
                child = '/us/investment-guide/';
            }
        } else if (language === 'de'){
            if (url.match('\/sektoren\/')) {
                child = '/de/sektoren/';
            } else if (url.match('\/investitionsf.{1,6}hrer\/')) {
                child = '/de/investitionsführer/';
            }
        } else if (language === 'cn') {
            if (url.match('\/%E9%83%A8%E9%97%A8\/')) {
                child = '/cn/部门/';
            } else if (url.match('\/%E6%8A%95%E8%B5%84%E6%8C%87%E5%8D%97\/')) {
                child = '/cn/投资指南/';
            }
        }
        if ($('ul.nav a')) {
            $('ul.nav a[href="' + child + '"]').parent().addClass('active');
        }
    }

    // function zoomImageHoverLink() {
    //     if ($('.dfit-sectors-list__item')) {
    //         var itemHeight = $('.dfit-sectors-list__item').height();
    //         var itemWidth = $('.dfit-sectors-list__item').width();
    //         $('.dfit-sectors-list__item').css({height: itemHeight});
    //         $('.dfit-sectors-list__item').css({width: itemWidth});
    //     }
    // }

    $(window).on('resize', function () {
        calculateSidebarWidth ();
    });
</script>
